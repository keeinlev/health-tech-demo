{% extends 'base.html' %}

{% block title %}Appointment Prescription{% endblock %}

{% block body %}
    {% if message %}
        <div class="alert{% if message %}{% else %} display-hidden{% endif %}">
            <b><small style="margin: auto auto auto 30px" id="alert-message">{{ message }}</small></b>
        </div>
    {% else %}
        <div class='heading'>
            <h1>Appointment with Dr. {{ appt.doctor }} on {{ appt.date }}</h1>
            <h3>Patient: {{ appt.patient }}</h4>
            <a href="{% if user.type == 'DOCTOR' %}{% url 'doctordashboard' %}{% elif user.type == 'PATIENT' %}{% url 'index' %}{% endif %}"><button class='btn-lg btn-block btn-primary'>Back</button></a>
        </div>
        
        {% if user.is_authenticated %}
            {% if user.type == 'DOCTOR' %}
                <form method='post' autocomplete="off" class='siteform'>
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <div class='row'>
                        <div class='col'>
                            {{ form.prescription.label }}
                        </div>
                        <div class='col'>
                            {{ form.notes.label }}
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col'>
                            {{ form.prescription.errors }}
                            {{ form.prescription }}
                        </div>
                        <div class='col'>
                            {{ form.notes.errors }}
                            {{ form.notes }}
                        </div>
                    </div>
                    <div class='row' style='margin-top:20px'>
                        <div class='col-12'>
                            {{ form.track_number.label }}
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col-6'>
                            {{ form.track_number.errors }}
                            {{ form.track_number }}
                        </div>
                    </div>
                    <input type="submit" class="btn-lg btn-block btn-secondary" style='margin-top: 20px;'>
                </form>
            {% else %}
                <div class='section'>
                    <div style='margin:50px;'>
                        <label for='presc'>Prescription:</label>
                        <div class='row' style='margin-bottom: 20px;'>
                            <div class='col'>
                                <div id='presc'>
                                    {% if details.prescription %}
                                        {{ details.prescription }}
                                    {% else %}
                                        None
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <label for='p_track'>Prescription Tracking Number:</label>
                        <div class='row' style='margin-bottom: 20px;'>
                            <div class='col'>
                                <div id='p_track'>
                                    {% if details.track_number %}
                                        {{ details.track_number }}
                                    {% else %}
                                        None
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <label for='apptnotes'>Appointment Notes:</label>
                        <div class='row' style='margin-bottom: 20px;'>
                            <div class='col'>
                                <div id='apptnotes'>
                                    {% if details.notes %}
                                        {{ details.notes }}
                                    {% else %}
                                        None
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endif %}
    {% endif %}
{% endblock %}